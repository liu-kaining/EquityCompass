# æ™ºç­–è‚¡æ (EquityCompass)

ä¸€ä¸ªåŸºäºAIçš„æ™ºèƒ½è‚¡ç¥¨åˆ†æå¹³å°ï¼Œæä¾›ä¸“ä¸šçš„è‚¡ç¥¨åˆ†ææŠ¥å‘Šå’ŒæŠ•èµ„å»ºè®®ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **AIæ™ºèƒ½åˆ†æ**: æ”¯æŒå¤šç§AIæ¨¡å‹ï¼ˆDeepSeekã€é€šä¹‰åƒé—®ã€OpenAIã€Geminiï¼‰
- **è‚¡ç¥¨å…³æ³¨åˆ—è¡¨**: ç”¨æˆ·å¯ä»¥å…³æ³¨æ„Ÿå…´è¶£çš„è‚¡ç¥¨ï¼Œæœ€å¤š20æ”¯
- **æ‰¹é‡åˆ†æ**: æ”¯æŒå•æ”¯è‚¡ç¥¨å’Œæ‰¹é‡è‚¡ç¥¨åˆ†æ
- **åˆ†ææŠ¥å‘Š**: ç”Ÿæˆä¸“ä¸šçš„è‚¡ç¥¨åˆ†ææŠ¥å‘Šï¼ŒåŒ…å«åŸºæœ¬é¢å’ŒæŠ€æœ¯é¢åˆ†æ
- **æŠ¥å‘Šç®¡ç†**: æŸ¥çœ‹ã€ä¸‹è½½ã€å¯¼å‡ºåˆ†ææŠ¥å‘Š
- **ä»»åŠ¡ç®¡ç†**: å®æ—¶æŸ¥çœ‹åˆ†æä»»åŠ¡çŠ¶æ€ï¼Œæ”¯æŒæš‚åœã€åˆ é™¤ã€é‡è¯•æ“ä½œ

### ç”¨æˆ·ç®¡ç†
- **ç”¨æˆ·æ³¨å†Œ/ç™»å½•**: æ”¯æŒé‚®ç®±æ³¨å†Œå’Œç™»å½•
- **é‚®ç®±éªŒè¯**: æ³¨å†Œæ—¶å‘é€éªŒè¯ç åˆ°é‚®ç®±
- **ç®¡ç†å‘˜åŠŸèƒ½**: ç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹å…¨å±€ç»Ÿè®¡å’Œç®¡ç†ç”¨æˆ·

### æ•°æ®ç»Ÿè®¡
- **å…¨å±€ç»Ÿè®¡**: æ€»æŠ¥å‘Šæ•°ã€æµè§ˆæ¬¡æ•°ã€ä¸‹è½½æ¬¡æ•°ç­‰
- **æ¯æ—¥ç»Ÿè®¡**: æŒ‰æ—¥æœŸç»Ÿè®¡åˆ†æè¶‹åŠ¿
- **çƒ­é—¨æŠ¥å‘Š**: æ˜¾ç¤ºæœ€å—æ¬¢è¿çš„åˆ†ææŠ¥å‘Š
- **æ•°æ®æ¸…ç†**: ç®¡ç†å‘˜å¯ä»¥ä¸€é”®æ¸…ç©ºæ‰€æœ‰ç»Ÿè®¡æ•°æ®

### æŠ€æœ¯ç‰¹æ€§
- **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯è®¿é—®
- **å®æ—¶æ›´æ–°**: ä»»åŠ¡çŠ¶æ€å®æ—¶æ›´æ–°
- **PDFå¯¼å‡º**: æ”¯æŒå°†åˆ†ææŠ¥å‘Šå¯¼å‡ºä¸ºPDFæ ¼å¼
- **æ‰¹é‡å¯¼å‡º**: æ”¯æŒæ‰¹é‡å¯¼å‡ºå¤šä¸ªæŠ¥å‘Šä¸ºZIPæ–‡ä»¶
- **è®¿å®¢æ¨¡å¼**: æ— éœ€ç™»å½•å³å¯æŸ¥çœ‹å…¬å¼€æŠ¥å‘Š

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: Flask 2.3.3
- **æ•°æ®åº“**: SQLite (å¼€å‘) / PostgreSQL (ç”Ÿäº§)
- **ORM**: SQLAlchemy 2.0+
- **è®¤è¯**: Flask-Login + JWT
- **é‚®ä»¶**: Flask-Mail
- **AIé›†æˆ**: OpenAI, Google Gemini, é˜¿é‡Œäº‘é€šä¹‰åƒé—®, DeepSeek

### å‰ç«¯
- **æ¡†æ¶**: Bootstrap 5 + jQuery
- **å›¾æ ‡**: Font Awesome
- **å›¾è¡¨**: Chart.js
- **PDFç”Ÿæˆ**: Playwright + ReportLab

### éƒ¨ç½²
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **WebæœåŠ¡å™¨**: Gunicorn
- **åå‘ä»£ç†**: Nginx (ç”Ÿäº§ç¯å¢ƒ)

## ğŸ“¦ æœ¬åœ°éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- Node.js 16+ (ç”¨äºPlaywright)
- Git

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-username/EquityCompass.git
cd EquityCompass
```

### 2. åç«¯è®¾ç½®
```bash
cd backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å®‰è£…Playwrightæµè§ˆå™¨
playwright install chromium

# å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env  # æˆ–ä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨
```

### 3. é…ç½®ç¯å¢ƒå˜é‡
ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®ä»¥ä¸‹å…³é”®å‚æ•°ï¼š

```env
# åŸºæœ¬é…ç½®
FLASK_ENV=development
SECRET_KEY=your-secret-key-here
JWT_SECRET_KEY=your-jwt-secret-key-here

# AIæ¨¡å‹é…ç½®ï¼ˆè‡³å°‘é…ç½®ä¸€ä¸ªï¼‰
DEEPSEEK_API_KEY=your-deepseek-api-key
QWEN_API_KEY=your-qwen-api-key
OPENAI_API_KEY=your-openai-api-key
GEMINI_API_KEY=your-gemini-api-key

# é‚®ä»¶é…ç½®ï¼ˆå¯é€‰ï¼‰
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SEND_EMAIL=True

# ç®¡ç†å‘˜é…ç½®
ADMIN_EMAIL=admin@equitycompass.com
```

### 4. åˆå§‹åŒ–æ•°æ®åº“
```bash
# åˆå§‹åŒ–æ•°æ®åº“
python scripts/init_db.py

# åˆ›å»ºæµ‹è¯•æ•°æ®ï¼ˆå¯é€‰ï¼‰
python create_test_statistics_data.py
```

### 5. å¯åŠ¨åº”ç”¨
```bash
# å¼€å‘æ¨¡å¼
python run.py

# æˆ–ä½¿ç”¨è„šæœ¬
./scripts/start_dev.sh
```

åº”ç”¨å°†åœ¨ http://localhost:5002 å¯åŠ¨

### 6. è®¿é—®åº”ç”¨
- ä¸»é¡µ: http://localhost:5002
- ç®¡ç†å‘˜ç™»å½•: ä½¿ç”¨ `ADMIN_EMAIL` é…ç½®çš„é‚®ç®±ï¼Œå¯†ç ä¸º `admin123`

## ğŸ³ Dockeréƒ¨ç½²

### 1. ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶
cp backend/env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 2. æ‰‹åŠ¨Dockeréƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t equitycompass .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name equitycompass \
  -p 5002:5002 \
  -v $(pwd)/data:/app/data \
  -v $(pwd)/.env:/app/.env \
  equitycompass
```

### 3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# ä½¿ç”¨ç”Ÿäº§é…ç½®
docker-compose -f docker-compose.prod.yml up -d
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
EquityCompass/
â”œâ”€â”€ backend/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ app/                # Flaskåº”ç”¨
â”‚   â”‚   â”œâ”€â”€ api/            # APIæ¥å£
â”‚   â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ templates/      # HTMLæ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ static/         # é™æ€æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ views/          # è§†å›¾å‡½æ•°
â”‚   â”œâ”€â”€ data/               # æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ tests/              # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ scripts/            # è„šæœ¬æ–‡ä»¶
â”‚   â”œâ”€â”€ requirements.txt    # Pythonä¾èµ–
â”‚   â””â”€â”€ run.py             # å¯åŠ¨æ–‡ä»¶
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”œâ”€â”€ scripts/                # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docker-compose.yml      # Dockeré…ç½®
â”œâ”€â”€ Dockerfile             # Dockeré•œåƒ
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ å¼€å‘æŒ‡å—

### è¿è¡Œæµ‹è¯•
```bash
cd backend
python -m pytest tests/ -v
```

### ä»£ç æ ¼å¼åŒ–
```bash
# æ ¼å¼åŒ–ä»£ç 
black app/

# æ£€æŸ¥ä»£ç è´¨é‡
flake8 app/
```

### æ•°æ®åº“è¿ç§»
```bash
# åˆ›å»ºè¿ç§»
flask db migrate -m "æè¿°"

# åº”ç”¨è¿ç§»
flask db upgrade
```

## ğŸ”‘ APIæ–‡æ¡£

### è®¤è¯æ¥å£
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/verify` - é‚®ç®±éªŒè¯

### åˆ†ææ¥å£
- `POST /api/analysis/single` - å•æ”¯è‚¡ç¥¨åˆ†æ
- `POST /api/analysis/batch` - æ‰¹é‡è‚¡ç¥¨åˆ†æ
- `GET /api/analysis/tasks` - è·å–ä»»åŠ¡åˆ—è¡¨
- `POST /api/analysis/tasks/{task_id}/pause` - æš‚åœä»»åŠ¡
- `DELETE /api/analysis/tasks/{task_id}` - åˆ é™¤ä»»åŠ¡

### æŠ¥å‘Šæ¥å£
- `GET /reports/` - æŠ¥å‘Šåˆ—è¡¨
- `GET /reports/{stock_code}` - æŠ¥å‘Šè¯¦æƒ…
- `GET /reports/{stock_code}/export-pdf` - å¯¼å‡ºPDF
- `POST /reports/batch-export` - æ‰¹é‡å¯¼å‡º

### ç»Ÿè®¡æ¥å£
- `GET /api/report-statistics/global-stats` - å…¨å±€ç»Ÿè®¡
- `GET /api/report-statistics/daily-stats` - æ¯æ—¥ç»Ÿè®¡
- `GET /api/report-statistics/popular` - çƒ­é—¨æŠ¥å‘Š
- `POST /api/report-statistics/clear-all` - æ¸…ç©ºç»Ÿè®¡ï¼ˆç®¡ç†å‘˜ï¼‰

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **AIåˆ†æå¤±è´¥**
   - æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®é…ç½®
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
   - æŸ¥çœ‹åº”ç”¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

2. **é‚®ä»¶å‘é€å¤±è´¥**
   - æ£€æŸ¥SMTPé…ç½®
   - ç¡®è®¤é‚®ç®±å¯†ç ä¸ºåº”ç”¨ä¸“ç”¨å¯†ç 
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

3. **PDFå¯¼å‡ºå¤±è´¥**
   - ç¡®è®¤Playwrightå·²æ­£ç¡®å®‰è£…
   - æ£€æŸ¥æµè§ˆå™¨ä¾èµ–
   - æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ

4. **æ•°æ®åº“è¿æ¥é—®é¢˜**
   - æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æƒé™
   - ç¡®è®¤æ•°æ®åº“è·¯å¾„æ­£ç¡®
   - æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f backend/app.log

# æŸ¥çœ‹Dockeræ—¥å¿—
docker-compose logs -f
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®é“¾æ¥: [https://github.com/your-username/EquityCompass](https://github.com/your-username/EquityCompass)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/your-username/EquityCompass/issues)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š
- [Flask](https://flask.palletsprojects.com/)
- [Bootstrap](https://getbootstrap.com/)
- [Chart.js](https://www.chartjs.org/)
- [Font Awesome](https://fontawesome.com/)
- [Playwright](https://playwright.dev/)

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºé¡¹ç›®ï¼Œè¯·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‰è¿›è¡Œå……åˆ†çš„å®‰å…¨é…ç½®å’Œæµ‹è¯•ã€‚